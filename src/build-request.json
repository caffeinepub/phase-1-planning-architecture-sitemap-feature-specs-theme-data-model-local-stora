{
  "kind": "build_request",
  "title": "Testimony approval/verification workflow + Search Artifacts indexing with controlled discoverability",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Implement a testimony verification workflow where testimonies are publicly visible on the Testimonies page immediately after submission but are clearly labeled as \"Awaiting Admin Verification\" until an admin approves them; once approved in the admin dashboard, the testimony becomes verified (status changes) and is treated as approved/verified in the UI.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "Once they are approved in the admin dashboard, they are verified and they get pushed out to the testimonies page.Number two, yes. Awaiting admin verification on the public testimonies page, yes."
        ]
      },
      "acceptanceCriteria": [
        "Submitting a testimony results in it appearing on the public Testimonies page with a visible \"Awaiting Admin Verification\" label/badge.",
        "After an admin approves a testimony, the public Testimonies page updates to show that testimony as verified/approved (no longer labeled \"Awaiting Admin Verification\").",
        "Admin approval action is available in the admin dashboard and persists in the backend so the status survives refresh/redeploy."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Add backend APIs and storage updates to support testimony approval and verified status changes by admins, including audit logging for the approval action (using the existing audit log system).",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "Once they are approved in the admin dashboard, they are verified"
        ]
      },
      "acceptanceCriteria": [
        "Backend exposes an admin-only method to approve/verify a testimony by id.",
        "Calling the approve/verify method updates stored testimony state so subsequent list calls return the updated status.",
        "An audit log entry is recorded for the approval action type when an admin approves/verifies a testimony.",
        "Non-admin callers cannot approve/verify testimonies (backend rejects/traps)."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Update the Admin Testimonies UI to support reviewing and approving/verifying testimonies: show clear status (Pending vs Verified/Approved) and provide an action to approve pending testimonies, with React Query invalidation so both admin and public views refresh.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "approved in the admin dashboard"
        ]
      },
      "acceptanceCriteria": [
        "Admin testimonies tab shows each testimony’s current status.",
        "Pending testimonies have an \"Approve\" (or equivalent) control.",
        "Approving from the admin UI updates the item status without requiring a hard refresh (queries invalidate/refetch).",
        "Error states are handled using existing patterns (inline error + retry)."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Create a Search Artifacts system from scratch that supports keyword search and filtered/categorized results (including a \"Testimonies\" category), and automatically indexes each testimony’s title/description and media descriptions so testimonies can be discovered via Search Artifacts search.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "create a whole full search artifact system from scratch! With testimonies as artifact type!"
        ]
      },
      "acceptanceCriteria": [
        "A new Search Artifacts UI exists where users can enter a keyword query and see results.",
        "Search results support filtering by category, including \"Testimonies\".",
        "Newly submitted testimonies become searchable via Search Artifacts without manual re-entry.",
        "Search indexing includes testimony textual fields and per-media description text (photos/videos).",
        "The backend provides query methods needed for search and category filtering."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Enforce controlled discoverability for testimonies: testimonies must not appear on any other pages or global listings besides (1) the public Testimonies page and (2) Search Artifacts search results.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "They shouldn't be found anywhere else besides the testimonies page or by searching in search artifacts section."
        ]
      },
      "acceptanceCriteria": [
        "No other existing pages/components display testimony lists/cards/teasers by default.",
        "Only the Testimonies route and the Search Artifacts route surface testimonies to non-admin users.",
        "Admin dashboard may list testimonies for review, but public discovery outside Testimonies and Search Artifacts does not occur."
      ]
    },
    {
      "id": "REQ-6",
      "text": "Implement responsive layout support across the entire website so all pages/forms/dashboards/navigation/testimonies/media upload components scale correctly on mobile, tablet, desktop, and large screens, with readable spacing, properly scaled images/videos, and touch-friendly menus/buttons.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-phase6i"
        ],
        "quotes": [
          "Build responsive layout support across the entire website so all pages, forms, dashboards, testimonies, media uploads, and navigation elements display correctly on mobile phones, tablets, desktop monitors, and large screens. Layouts must automatically scale, maintain readable spacing, resize images and videos properly, and ensure all menus and buttons function for both touch and mouse users."
        ]
      },
      "acceptanceCriteria": [
        "Key pages (Homepage, Shop, Submit Request, Admin, AdminPlus, Testimonies, Inbox, FAQ, Contact) render without horizontal overflow at common breakpoints.",
        "Header navigation works on touch devices (mobile menu opens/closes and is usable).",
        "Media grids (including testimony media) adapt columns appropriately and videos/images keep correct aspect ratios using responsive sizing classes.",
        "Forms and dialogs remain usable on small screens (no clipped content; scroll within dialogs where needed)."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in backend/main.mo (no additional backend services).",
    "Do not edit frontend immutable paths: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or any files under frontend/src/components/ui; compose using existing components instead.",
    "All user-facing text must be in English.",
    "If backend state schema changes require an upgrade path, add backend/migration.mo using the platform's conditional migration policy; otherwise do not create migration.mo."
  ],
  "nonGoals": [
    "Implementing third-party search providers or external databases for indexing/search.",
    "Adding WebSocket/real-time updates; use existing polling/invalidation via React Query.",
    "Adding third-party authentication beyond Internet Identity.",
    "Changing the existing design theme beyond what is necessary to achieve responsiveness and the new testimony/search features."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}